# 数据概览功能说明

## 功能概述

本次更新为管理员数据概览页面添加了两个重要的图表功能：

### 1. 用户增长趋势图
- **功能描述**: 显示系统用户注册的增长趋势
- **图表类型**: 折线图（带面积填充）
- **时间维度**: 支持按周、月、年查看
- **数据来源**: 后端API `/api/stats/user-growth-trend`
- **交互功能**: 
  - 点击时间维度按钮（周/月/年）切换数据
  - 鼠标悬停显示具体数值
  - 自动刷新数据

### 2. 课题难度分布图
- **功能描述**: 显示系统中不同难度课题的分布情况
- **图表类型**: 环形饼图
- **难度等级**: 简单、中等、困难
- **数据来源**: 后端API `/api/stats/topic-difficulty-distribution`
- **交互功能**:
  - 鼠标悬停显示详细信息和百分比
  - 图例显示各难度等级
  - 自动计算百分比

## 技术实现

### 前端技术栈
- **图表库**: ECharts 5.x + vue-echarts 6.x
- **框架**: Vue 2.6 + Element UI
- **数据获取**: Axios HTTP客户端

### 后端技术栈
- **框架**: Spring Boot 2.x
- **数据库**: MySQL 8.0
- **ORM**: MyBatis Plus
- **数据查询**: 动态SQL查询

### 新增API接口

#### 1. 用户增长趋势接口
```
GET /api/stats/user-growth-trend?period={week|month|year}
```

**响应格式**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "timeLabels": ["2024-01", "2024-02", "2024-03"],
    "userCounts": [5, 8, 12],
    "period": "month"
  }
}
```

#### 2. 课题难度分布接口
```
GET /api/stats/topic-difficulty-distribution
```

**响应格式**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "pieData": [
      {"name": "简单", "value": 2},
      {"name": "中等", "value": 3},
      {"name": "困难", "value": 1}
    ],
    "total": 6
  }
}
```

## 数据库查询优化

### 用户增长趋势查询
使用动态SQL根据时间维度进行分组统计：
- **周维度**: `DATE_FORMAT(create_time, '%Y-%u')`
- **月维度**: `DATE_FORMAT(create_time, '%Y-%m')`
- **年维度**: `DATE_FORMAT(create_time, '%Y')`

### 课题难度分布查询
直接按难度字段分组统计：
```sql
SELECT difficulty, COUNT(*) as count 
FROM sys_topic 
WHERE deleted = 0 
GROUP BY difficulty
```

## 使用说明

### 1. 启动系统
1. 启动后端服务：`mvn spring-boot:run`
2. 启动前端服务：`npm run serve`
3. 使用管理员账号登录系统

### 2. 查看数据概览
1. 登录后进入管理员面板
2. 点击"数据概览"菜单
3. 页面将自动加载并显示图表

### 3. 交互操作
- **切换时间维度**: 点击用户增长趋势图上方的时间按钮
- **查看详细信息**: 鼠标悬停在图表上查看具体数值
- **刷新数据**: 页面会自动刷新，也可手动刷新浏览器

## 测试数据

系统已预置测试数据，包括：
- 管理员用户：`admin` / `123456`
- 教师用户：`teacher001` / `123456`
- 学生用户：`student001` / `123456`
- 示例课题：6个不同难度的课题
- 示例选题记录：3条选题记录

## 注意事项

1. **权限控制**: 只有管理员角色可以访问统计接口
2. **数据安全**: 所有接口都经过JWT认证
3. **性能优化**: 数据库查询已添加索引优化
4. **错误处理**: 前端包含完整的错误处理和用户提示
5. **响应式设计**: 图表支持不同屏幕尺寸的自适应

## 后续扩展

可以考虑添加的功能：
- 更多时间维度的选择（季度、半年等）
- 数据导出功能（Excel、PDF）
- 实时数据更新
- 更多图表类型（柱状图、雷达图等）
- 数据对比功能（同比、环比）
